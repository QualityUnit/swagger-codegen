<?php
/**
 * Auto generated code from swagger api description. DO NOT EDIT !!!!
 * Codegen version: {{codegenVersion}}
 */
require '../../scripts/bootstrap_api.php';

$app = new \Slim\Slim();

try {
    RestApi_Make::init(new {{apiPackage}}_Make);
} catch (Exception $ignore) {}

try {
    // You must implement this class, it will not be generated !!! It must extend RestApi_Auth
    $auth = {{apiPackage}}_Auth::init($app->request());
} catch (Exception $e) {
    $response = new RestApi_Response($app->response());
    $response->setError($e);
    $response->send();
    exit();
}
{{#apiInfo}}{{#apis}}{{#operations}}{{#operation}}
/*
 * {{notes}}
 */
$app->{{httpMethod}}('{{#fnSlimPath}}{{path}}{{/fnSlimPath}}', function ({{#pathParams}}${{paramName}}{{#hasMore}}, {{/hasMore}}{{/pathParams}}) use ($app, $auth) {
    $params = new RestApi_Params($app->request(){{#authMethods}}, array({{#scopes}}'{{scope}}'{{#hasMore}}, {{/hasMore}}{{/scopes}}){{/authMethods}});
    $response = new RestApi_Response($app->response());
    try { {{#allParams}}{{^isPathParam}}{{^isBodyParam}}
        $params->check('{{paramName}}', {{#required}}true{{/required}}{{^required}}false{{/required}}, '{{defaultValue}}', '{{dataType}}', {{#isEnum}}array({{#allowableValues}}{{#values}}'{{.}}'{{^-last}}, {{/-last}}{{/values}}{{/allowableValues}}){{/isEnum}}{{^isEnum}}null{{/isEnum}});{{/isBodyParam}}{{/isPathParam}}{{/allParams}}{{#authMethods}}
        $auth->checkScope($params->getScopes());{{/authMethods}}{{#bodyParam}}{{^dataType}}
        $data = $params->getBody(){{/dataType}}{{#dataType}}
        $data = new {{dataType}}($params->getBody());
        $data->check();{{/dataType}}{{/bodyParam}}
        $handler = new {{#fnClassName}}{{operationId}}{{/fnClassName}}($params);
        $response->setResult($handler->{{#fnMethodName}}{{operationId}}{{/fnMethodName}}({{#pathParams}}${{paramName}}{{#hasMore}}, {{/hasMore}}{{/pathParams}}{{#bodyParam}}{{#hasPathParams}}, {{/hasPathParams}}$data{{/bodyParam}}));
    } catch (Exception $e) {
        $response->setError($e);
    }
});
{{/operation}}{{/operations}}{{/apis}}{{/apiInfo}}
$app->run();
